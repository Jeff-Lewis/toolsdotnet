== On Silverlight plugin load/hang timeout in FF ==


http://kb.mozillazine.org/index.php?title=Plugin-container_and_out-of-process_plugins&printable=yes

about:config

dom.ipc.plugins.enabled.npctrl.dll

== On Extending Silverlight Unit test framework II ==
Invoke method of the CompositeWorkItem:
{{{
public override bool Invoke()
{
    bool flag;
    bool canExecuteImmediately = false;
    do
    {
        WorkItem item;
        flag = this.Invoke(out item);
        if (item != null)
        {
            canExecuteImmediately = item.CanExecuteImmediately;
        }
    }
    while (flag && canExecuteImmediately);
    return flag;
}
}}}
CanExecuteImmediately property of WorkItem, Invoke of a WorkItem is:
{{{
public virtual bool Invoke()
{
    return !this.IsComplete;
}
}}}

== On locking techniques in Silverlight - CLog case study ==

{{{

        void Page_Loaded(object sender, RoutedEventArgs e)
        {

            for (int i = 0; i < 2; i++)
            {

                ThreadPool.QueueUserWorkItem((state) => log.Info("This is a call with i="+state), i);
                LogViewer.OfflineMode = false;
                if (log.InfoEnabled)
                {
                    log.Info("UI" +Thread.CurrentThread.ManagedThreadId.ToString());
                }
            }
        }
}}}

{{{

lock (loggingConfigLock)
                {
....

clogService.BeginGetConfiguration(clientInfo,
                            asyncResult =>
                            {
                                ClientConfigurationData result;
                                try
{ .....
}}}

{{{
public interface IClogService {
        System.IAsyncResult BeginGetConfiguration(object clientInfo, System.AsyncCallback callback, object asyncState);
        
        DanielVaughan.Logging.ClientLogging.ClientConfigurationData EndGetConfiguration(System.IAsyncResult result);
}
}}}

{{{
    public partial class ClogServiceClient : System.ServiceModel.ClientBase<DanielVaughan.Logging.ClientLogging.IClogService>, DanielVaughan.Logging.ClientLogging.IClogService {
        public void GetConfigurationAsync(object clientInfo, object userState) {
            if ((this.onBeginGetConfigurationDelegate == null)) {
                this.onBeginGetConfigurationDelegate = new BeginOperationDelegate(this.OnBeginGetConfiguration);
            }
            if ((this.onEndGetConfigurationDelegate == null)) {
                this.onEndGetConfigurationDelegate = new EndOperationDelegate(this.OnEndGetConfiguration);
            }
            if ((this.onGetConfigurationCompletedDelegate == null)) {
                this.onGetConfigurationCompletedDelegate = new System.Threading.SendOrPostCallback(this.OnGetConfigurationCompleted);
            }
            base.InvokeAsync(this.onBeginGetConfigurationDelegate, new object[] {
                        clientInfo}, this.onEndGetConfigurationDelegate, this.onGetConfigurationCompletedDelegate, userState);
        }
...
}
}}}


== On extending Silverlight Unit Test harness ==

published: http://plainoldstan.blogspot.com/2010/06/extending-silverlight-unit-testing.html

== On using partial class to isolate silverlight wcf client to its interface ==
{{{
        public SiteSettingsContext(CommonServiceClient client) : this()
        {
            if ( client == null ) throw new ArgumentNullException("client");
            _client = client;
        }

    public interface ITerminologyService
    {
        event System.EventHandler<GetTerminologyListCompletedEventArgs> GetTerminologyListCompleted;
        void GetTerminologyListAsync();
    }

public partial class CommonServiceClient : ITerminologyService

    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "3.0.0.0")]
    [System.ServiceModel.ServiceContractAttribute(ConfigurationName="CommonService.ICommonService")]
    public interface ICommonService {
        
        [System.ServiceModel.OperationContractAttribute(AsyncPattern=true, Action="http://tempuri.org/ITerminologyProvider/GetTerminologyList", ReplyAction="http://tempuri.org/ITerminologyProvider/GetTerminologyListResponse")]
        System.IAsyncResult BeginGetTerminologyList(System.AsyncCallback callback, object asyncState);
        
        System.Collections.ObjectModel.ObservableCollection<Valtera.WcfServices.Client.CommonService.Terminology> EndGetTerminologyList(System.IAsyncResult result);


private ITerminologyService _client = new CommonServiceClient();

        public SiteSettingsContext(ITerminologyService client)
            : this()
        {
            if ( client == null ) throw new ArgumentNullException("client");
            _client = client;
        }

}}}

== On using Moq with/for events ==
{{{

protected override void TestInitialize()
        {
            base.TestInitialize();
            _terminologyService = AutoMockRegistrator.CreateDynaMockFor<ITerminologyService>();

            _context = IoC.Resolve<SiteSettingsContext>();
        }

        [TestMethod]
        [ExpectedException(typeof(InvalidOperationException))]
        public void Should_ThrowWhenUsedAndNotLoadedYet()
        {
            var context = new SiteSettingsContext(_terminologyService.Object);
            var terminologies = context.GetTerminologies();
        }
        [TestMethod]
        [Asynchronous]
        [Timeout(500)]
        public void Should_HaveTerminologiesAfterLoad()
        {
            var context = new SiteSettingsContext(new TerminologyServiceStub());

            context.LoadCompleted += ( s, e ) =>
            {
                AssertForFixedTerminologies(context.GetTerminologies());
                EnqueueTestComplete();
            };
            context.Load();
        }
        [TestMethod]
        [Asynchronous]
        [Timeout(500)]
        public void Should_HaveTerminologiesAfterLoadMoq()
        {
            _terminologyService.Setup(t => t.GetTerminologyListAsync()).Callback(()=>
            {
                _terminologyService.Raise(ts => ts.GetTerminologyListCompleted += null, new GetTerminologyListCompletedEventArgs(TerminologyFake.GetFixedActionPlanTerminology(), null,
false, null));
            });

            var context = new SiteSettingsContext(_terminologyService.Object);

            context.LoadCompleted += (s, e) =>
            {
                AssertForFixedTerminologies(context.GetTerminologies());
                EnqueueTestComplete();
            };
            context.Load();
        }


        internal class TerminologyServiceStub : ITerminologyService
        {
            public event EventHandler<GetTerminologyListCompletedEventArgs> GetTerminologyListCompleted;
            public void GetTerminologyListAsync()
            {
                // Verify that event has been subscribed to
                Assert.IsNotNull(GetTerminologyListCompleted);
                // Raise the event
                GetTerminologyListCompleted(this,
                    new GetTerminologyListCompletedEventArgs(TerminologyFake.GetFixedActionPlanTerminology(), null,
                        false, null));
            }
        }

}}}

== On logging from Silverlight to Browser console ==

published: http://plainoldstan.blogspot.com/2010/06/silverlight-browser-console-logger.html

== On TlbImp : error TI0000: Encountered multiple versions of the assembly with GUID ==
https://connect.microsoft.com/VisualStudio/feedback/details/565978/tlbimp-encountered-multiple-versions-of-the-assembly-with-guid-000204ef-0000-0000-c000-000000000046?wa=wsignin1.0#tabs

== On Attempt to access the method failed - ArrayList ==
http://forums.silverlight.net/forums/p/1456/4118.aspx